<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
  <link rel="icon" type="image/webp" href="/RMLogo.webp" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rareminds - Skillpassport</title>
    
    <style>
      /* Hide Zoho widget on student pages */
      body.hide-zoho-widget #zsiq_float,
      body.hide-zoho-widget .zsiq_floatmain,
      body.hide-zoho-widget .zsiq_float,
      body.hide-zoho-widget div[id^="siqiframe"],
      body.hide-zoho-widget div[id*="zsalesiq"],
      body.hide-zoho-widget iframe[id*="siq"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        pointer-events: none !important;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>

    <!-- Zoho SalesIQ Widget - Chat window starts minimized, opens only on click -->
    <script>
      (function() {
        // Function to check if on home page
        function isHomePage() {
          const path = window.location.pathname;
          return path === '/' || path === '';
        }
        
        // Function to update widget visibility
        function updateWidgetVisibility() {
          if (window.$zoho && window.$zoho.salesiq && window.$zoho.salesiq.floatwindow) {
            if (isHomePage()) {
              document.body.classList.remove('hide-zoho-widget');
            } else {
              $zoho.salesiq.floatwindow.visible('hide');
              document.body.classList.add('hide-zoho-widget');
            }
          }
        }
        
        // Load the widget
        window.$zoho = window.$zoho || {};
        $zoho.salesiq = $zoho.salesiq || {
          widgetcode: "siq85740827d442fdfad727c23eb50d61276e1e478af9841b5169a99498fc35da01", 
          values:{}, 
          ready:function(){
            console.log('Zoho CRM widget loaded');
            // Keep chat window minimized on load - only open when user clicks
            if (window.$zoho && window.$zoho.salesiq && window.$zoho.salesiq.chatwindow) {
              $zoho.salesiq.chatwindow.visible('hide');
            }
            // Initial visibility check
            setTimeout(updateWidgetVisibility, 500);
          }
        };
        
        var script = document.createElement('script');
        script.src = 'https://salesiq.zohopublic.in/widget?wc=siq85740827d442fdfad727c23eb50d61276e1e478af9841b5169a99498fc35da01';
        script.id = 'zsiqscript';
        script.defer = true;
        document.head.appendChild(script);
        
        // Monitor route changes for SPA
        let lastPath = window.location.pathname;
        setInterval(function() {
          if (lastPath !== window.location.pathname) {
            lastPath = window.location.pathname;
            updateWidgetVisibility();
          }
        }, 300);
        
        // Also listen to popstate for back/forward navigation
        window.addEventListener('popstate', updateWidgetVisibility);
      })();
    </script>

  </body>
</html>
